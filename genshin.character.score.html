<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸç¥ ãƒ“ãƒ«ãƒ‰æƒ…å ±ãƒ“ãƒ¥ãƒ¼ã‚¢ (Enka.Network)</title>
    <style>
        /* ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° */
        body {
            font-family: Arial, sans-serif;
            background-color: #2e3440; /* Nordãƒ†ãƒ¼ãƒã®ãƒ€ãƒ¼ã‚¯ã‚«ãƒ©ãƒ¼ */
            color: #d8dee9;
            padding: 20px;
            text-align: center;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #3b4252;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }
        h1 {
            color: #88c0d0;
            margin-bottom: 20px;
        }
        input[type="text"], button {
            padding: 10px;
            border-radius: 5px;
            border: none;
            margin: 5px;
            font-size: 1em;
        }
        input[type="text"] {
            width: 60%;
            background-color: #4c566a;
            color: #eceff4;
        }
        button {
            background-color: #a3be8c; /* ç·‘ç³»ã®ãƒœã‚¿ãƒ³ */
            color: #2e3440;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #b4c798;
        }
        #result-area {
            margin-top: 30px;
            text-align: left;
        }
        .error {
            color: #bf616a; /* èµ¤ç³»ã®ã‚¨ãƒ©ãƒ¼è‰² */
            font-weight: bold;
        }
        .character-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .character-card {
            background-color: #4c566a;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .char-name {
            color: #ebcb8b; /* é»„è‰²ç³»ã®å¼·èª¿è‰² */
            font-size: 1.5em;
            margin-bottom: 10px;
            border-bottom: 1px solid #5e81ac;
            padding-bottom: 5px;
        }
        .stat-line {
            display: flex;
            justify-content: space-between;
            font-size: 0.9em;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>âš”ï¸ åŸç¥ ãƒ“ãƒ«ãƒ‰æƒ…å ±ãƒ“ãƒ¥ãƒ¼ã‚¢</h1>
    <p>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãŒå…¬é–‹ã•ã‚Œã¦ã„ã‚‹UIDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>

    <input type="text" id="uid-input" placeholder="åŸç¥ UID (ä¾‹: 618285856)">
    <button onclick="fetchBuildData()">ãƒ“ãƒ«ãƒ‰æƒ…å ±ã‚’å–å¾—</button>

    <div id="result-area">
        </div>
</div>

<script>
    const BASE_URL = "https://enka.network/api/uid/";

    // å–å¾—ã—ãŸã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼IDã‚’ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼åã«å¤‰æ›ã™ã‚‹ãŸã‚ã®è¾æ›¸
    // å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚ˆã‚ŠåŒ…æ‹¬çš„ãªè¾æ›¸ãŒå¿…è¦ã§ã™ã€‚
    const characterIdMap = {
        10000002: "ç¥é‡Œç¶¾è¯",
        10000003: "ã‚¸ãƒ³",
        10000005: "æ—…äºº(é¢¨)",
        10000006: "ãƒªã‚µ",
        10000007: "ã‚¬ã‚¤ã‚¢",
        10000014: "ãƒãƒ¼ãƒãƒ©",
        10000020: "ãƒ‡ã‚£ãƒ«ãƒƒã‚¯",
        10000021: "é¦™è±",
        10000022: "ãƒ™ãƒãƒƒãƒˆ",
        // ... (ã•ã‚‰ã«å¤šãã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼IDã‚’è¿½åŠ )
    };
    
    // ã‚¹ã‚³ã‚¢ã‚¿ã‚¤ãƒ—ã¨æ—¥æœ¬èªåã‚’ãƒãƒƒãƒ”ãƒ³ã‚° (ãƒ“ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ç”ŸæˆAPIã®ã‚¹ã‚³ã‚¢ã¨ã¯ç•°ãªã‚Šã¾ã™ãŒã€å‚è€ƒã¨ã—ã¦)
    const statMapping = {
        'FIGHT_PROP_ATTACK': 'æ”»æ’ƒåŠ›',
        'FIGHT_PROP_HP': 'HP',
        'FIGHT_PROP_DEFENSE': 'é˜²å¾¡åŠ›',
        'FIGHT_PROP_CRITICAL': 'ä¼šå¿ƒç‡',
        'FIGHT_PROP_CRITICAL_HURT': 'ä¼šå¿ƒãƒ€ãƒ¡ãƒ¼ã‚¸',
        'FIGHT_PROP_CHARGE_EFFICIENCY': 'å…ƒç´ ãƒãƒ£ãƒ¼ã‚¸åŠ¹ç‡',
        'FIGHT_PROP_ELEMENT_MASTERY': 'å…ƒç´ ç†ŸçŸ¥',
        // ... (å¿…è¦ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¿½åŠ )
    };


    async function fetchBuildData() {
        const uid = document.getElementById('uid-input').value.trim();
        const resultArea = document.getElementById('result-area');
        resultArea.innerHTML = '<h2>å–å¾—ä¸­...</h2>';
        
        if (!/^\d{9}$/.test(uid)) {
            resultArea.innerHTML = '<h2 class="error">âš ï¸ æœ‰åŠ¹ãª9æ¡ã®UIDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</h2>';
            return;
        }

        try {
            const url = `${BASE_URL}${uid}/`;
            const response = await fetch(url);
            
            // HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼å‡¦ç†
            if (!response.ok) {
                const errorMessages = {
                    400: "UIDã®å½¢å¼ãŒä¸æ­£ã§ã™ã€‚",
                    404: "ãã®UIDã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚",
                    424: "ã‚²ãƒ¼ãƒ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã¾ãŸã¯APIã‚·ã‚¹ãƒ†ãƒ å¤‰æ›´ä¸­ã§ã™ã€‚",
                    429: "ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆè¶…éã§ã™ã€‚æ™‚é–“ã‚’ãŠã„ã¦ãŠè©¦ã—ãã ã•ã„ã€‚",
                    500: "Enka.NetWorkã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚",
                    503: "Enka.NetWorkã‚µãƒ¼ãƒãƒ¼ãŒä¸€æ™‚åœæ­¢ä¸­ã§ã™ã€‚",
                };
                const status = response.status;
                const errorMessage = errorMessages[status] || `ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ (ã‚³ãƒ¼ãƒ‰: ${status})`;
                resultArea.innerHTML = `<h2 class="error">âŒ ${errorMessage}</h2>`;
                return;
            }

            const data = await response.json();
            
            // ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸå¾Œã®å‡¦ç†
            renderData(data, resultArea);

        } catch (error) {
            resultArea.innerHTML = '<h2 class="error">âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼: ã‚µãƒ¼ãƒãƒ¼ã¨ã®æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸã€‚</h2>';
            console.error('Fetch Error:', error);
        }
    }

    function renderData(data, resultArea) {
        if (!data.avatarInfoList || data.avatarInfoList.length === 0) {
            resultArea.innerHTML = '<h2>âš ï¸ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãŒéå…¬é–‹ã€ã¾ãŸã¯ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</h2>';
            return;
        }

        let htmlContent = `<h2>ğŸ‘¤ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±</h2>`;
        htmlContent += `<p><strong>ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ :</strong> ${data.playerInfo.nickname || 'N/A'}</p>`;
        htmlContent += `<p><strong>å†’é™ºãƒ©ãƒ³ã‚¯:</strong> ${data.playerInfo.level || 'N/A'}</p>`;
        htmlContent += `<p><strong>ä¸–ç•Œãƒ©ãƒ³ã‚¯:</strong> ${data.playerInfo.worldLevel || 'N/A'}</p>`;
        
        htmlContent += `<h2>âœ¨ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ“ãƒ«ãƒ‰ (${data.avatarInfoList.length}ä½“)</h2>`;
        htmlContent += `<div class="character-grid">`;

        data.avatarInfoList.forEach(avatar => {
            // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼IDã‹ã‚‰åå‰ã‚’å–å¾—
            const charName = characterIdMap[avatar.avatarId] || `ã‚­ãƒ£ãƒ©ID: ${avatar.avatarId}`;
            
            // ä¸»è¦ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’å–å¾—ï¼ˆå…¨ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒAPIã«å«ã¾ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰
            const stats = avatar.fightProp;

            // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚«ãƒ¼ãƒ‰HTMLã‚’ç”Ÿæˆ
            htmlContent += `
                <div class="character-card">
                    <div class="char-name">${charName}</div>
                    
                    ${stats ? `
                        <div class="stat-line"><span>${statMapping['FIGHT_PROP_HP']}:</span> <span>${Math.round(stats['FIGHT_PROP_HP'] + stats['FIGHT_PROP_BASE_HP'])}</span></div>
                        <div class="stat-line"><span>${statMapping['FIGHT_PROP_ATTACK']}:</span> <span>${Math.round(stats['FIGHT_PROP_ATTACK'] + stats['FIGHT_PROP_BASE_ATTACK'])}</span></div>
                        <div class="stat-line"><span>${statMapping['FIGHT_PROP_DEFENSE']}:</span> <span>${Math.round(stats['FIGHT_PROP_DEFENSE'] + stats['FIGHT_PROP_BASE_DEFENSE'])}</span></div>
                        <div class="stat-line"><span>${statMapping['FIGHT_PROP_CRITICAL']}:</span> <span>${(stats['FIGHT_PROP_CRITICAL'] * 100).toFixed(1)}%</span></div>
                        <div class="stat-line"><span>${statMapping['FIGHT_PROP_CRITICAL_HURT']}:</span> <span>${(stats['FIGHT_PROP_CRITICAL_HURT'] * 100).toFixed(1)}%</span></div>
                        <div class="stat-line"><span>${statMapping['FIGHT_PROP_CHARGE_EFFICIENCY']}:</span> <span>${(stats['FIGHT_PROP_CHARGE_EFFICIENCY'] * 100).toFixed(1)}%</span></div>
                        <div class="stat-line"><span>${statMapping['FIGHT_PROP_ELEMENT_MASTERY']}:</span> <span>${Math.round(stats['FIGHT_PROP_ELEMENT_MASTERY'])}</span></div>
                    ` : '<p>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ±ãªã—</p>'}
                    
                    <p style="margin-top: 10px; font-size: 0.8em; color: #8fbcbb;">ãƒ¬ãƒ™ãƒ«: ${avatar.propMap[4001].val}</p>
                </div>
            `;
        });

        htmlContent += `</div>`;
        resultArea.innerHTML = htmlContent;
    }
</script>

</body>
</html>
